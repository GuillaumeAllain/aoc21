i←⊃⎕NGET'../data/day5' 1
n←(⍎)¨(↑⍣2)(','(≠⊆⊢)¨(1 0 1/⊢))¨' '(≠⊆⊢)¨i
t←(0×⊢⍴(⍳(×/⊢)))(1+⌈/[1]⌈/[2]n)
o←{×/⊃×-/[1]⍵}¨(↓⍣2)n

l←{((⍳1⌷⊢),¨(⍳2⌷⊢))⊃1+|-/[1]⍵}¨(↓⍣2)n
c←{(⌊/[1]¨(0(⍎⍵)o)/(↓⍣2)n)}

f←{(c⍵)+(0(⍎⍵)o)/l}
v←f '='
dp←f '<'
f←{(c⍵)+↓¨({(⌽@(⌽¨2,¨⍳1⌷⍴⍵))⍵}↑)¨(0(⍎⍵)o)/l}
d←dp,f '>'

s←{⍴⍸⊃~2>+/1∘.{(⍺@⍵)t}⍵}
s v
s v,d
